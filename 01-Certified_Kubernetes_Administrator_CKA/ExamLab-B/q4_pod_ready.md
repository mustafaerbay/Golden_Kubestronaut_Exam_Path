# Question 4 | Pod Ready if Service is reachable

Solve this question on: ssh cka3200

Do the following in Namespace default:

1. Create a Pod named ready-if-service-ready of image nginx:1-alpine

2. Configure a LivenessProbe which simply executes command true

3. Configure a ReadinessProbe which does check if the url http://service-am-i-ready:80 is reachable, you can use wget -T2 -O- http://service-am-i-ready:80 for this

4. Start the Pod and confirm it isn't ready because of the ReadinessProbe.

Then:

5. Create a second Pod named am-i-ready of image nginx:1-alpine with label id: cross-server-ready

6. The already existing Service service-am-i-ready should now have that second Pod as endpoint

7. Now the first Pod should be in ready state, check that

---
### ANSWER

```
➜ ssh cka3200

➜ candidate@cka3200:~$ k run ready-if-service-ready --image=nginx:1-alpine --dry-run=client -o yaml > 4_pod1.yaml
```

```
# cka3200:/home/candidate/4_pod1.yaml
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    run: ready-if-service-ready
  name: ready-if-service-ready
spec:
  containers:
  - image: nginx:1-alpine
    name: ready-if-service-ready
    resources: {}
    livenessProbe:                                      # add from here
      exec:
        command:
        - 'true'
    readinessProbe:
      exec:
        command:
        - sh
        - -c
        - 'wget -T2 -O- http://service-am-i-ready:80'   # to here
  dnsPolicy: ClusterFirst
  restartPolicy: Always
status: {}
```

create the pod 

```
➜ candidate@cka3200:~$ candidate@cka3200:~$ k -f 4_pod1.yaml create
pod/ready-if-service-ready created

➜ candidate@cka3200:~$ k get pod ready-if-service-ready
NAME                     READY   STATUS    RESTARTS   AGE
ready-if-service-ready   0/1     Running   0          8s
```
create the second pod:
```
➜ candidate@cka3200:~$ k run am-i-ready --image=nginx:1-alpine --labels="id=cross-server-ready"
pod/am-i-ready created
```

```
➜ candidate@cka3200:~$ k get endpointslice service-am-i-ready-ch6d6 
NAME                       ADDRESSTYPE   PORTS   ENDPOINTS    AGE
service-am-i-ready-ch6d6   IPv4          80      10.44.0.30   6d19h
```

```
➜ candidate@cka3200:~$ k get pod ready-if-service-ready
NAME                     READY   STATUS    RESTARTS   AGE
ready-if-service-ready   1/1     Running   0          2m10s
```